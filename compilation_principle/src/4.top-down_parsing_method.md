第四章、自顶向下语法分析方法

[toc]

语法分析是编译程序的核⼼部分。

语法分析的作⽤: 识别由词法分析给出的单词符号串是否是给定⽂法的正确句⼦（程序）。

语法分析常⽤的⽅法可分为
- ⾃顶向下分析
- ⾃底向上分析  
两⼤类。

虽然语法分析可以通过
- 确定分析
- 者不确定分析  
来实现，但在实际的编译器构造中，⼏乎都是采⽤确定分析⽅式，不确定分析仅具有理论价值。

本章主要介绍⾃顶向下的确定分析。在第5、6章中，分别介绍两种确定的⾃底向上分析⽅法：算符优先分析和LR分析

⾃顶向下分析⽅法也称⾯向⽬标的分析⽅法，也就是从⽂法的开始符号出发企图推导出与输⼈的单词符号串完全相匹配的句⼦，若输⼊串是给定⽂法的句⼦，则必能推出，反之必然出错。

⾃顶向下的确定分析⽅法需对⽂法有⼀定的限制，但由于实现⽅法简单、直观，便于⼿⼯构造或⾃动⽣成语法分析器，因⽽仍是⽬前常⽤的⽅法之⼀。⽽⾃顶向下的不确定分析⽅法是带回溯的分析⽅法，这种⽅法实际上是⼀种穷举的试探⽅法，效率低，代价⾼，因⽽极少使⽤，仅在4.4节中粗略介绍。


# 确定的自顶向下分析方法

确定的⾃顶向下分析⽅法，是从⽂法的开始符号出发，考虑如何根据当前的输⼈符号（单词符号）**唯⼀**地确定选⽤哪个产⽣式替换相应⾮终结符以往下推导，或如何构造⼀棵相应的语法树


- 定义4.1
设$G = (V_T,V_N,P,S)$是上下文无关文法  
$$FIRST(a) = \{b | a \Rightarrow^* bA,a \in V_T,A \in V^*\}，若a \Rightarrow^* \epsilon，则规定\epsilon \in FIRST(a)$$
称$FIRST(a)$为$a$的开始符号集或首符号集
> 同一个非终结符的多个产生式，若右部的$FIRST$无交集，则推导是唯一，确定的    
> 考虑到$\epsilon$时，光是$FIRST$集合还不够唯一选择推导式


- 定义4.2
设$G = (V_T,V_N,P,S)$是上下文无关文法，$A \in V_N$，$S$是开始符号
$$FOLLOW(A) = \{a|S \Rightarrow^* bAc且a \in V_T,a \in FIRST(c),b \in V^*_T,c \in V^+\}$$
$$若S \Rightarrow^* bAc,且c \Rightarrow^* \epsilon,则\# \in FOLLOW(A)\}$$
也可定义为
$$FOLLOW(A) = \{ a | S \Rightarrow^* ...Aa...,a \in V_T\}$$
若有$S \Rightarrow^* ...A$，则规定$\# \in FOLLOW(A)$
> 这里用$\#$作为输入串的结束符，也称输入串括号。     

当文法中含有形如
$$A \to a$$
$$A \to b$$
的产生式时，其中$A \in V_N,a,b \in V^*$，若$a$和$b$不能同时推导出空,假定其中$a \nRightarrow^* \epsilon,b \Rightarrow^* \epsilon$(即其中一个可推出空规则，另为一个不能推出空规则时)，则当$FIRST(a) \cap (FIRST(b) \cup FOLLOW(A)) = \emptyset$时，对于非终结符$A$的替换可唯一的确定候选。


- 定义4.3
一个产生式的选择符号集$SELECT$。给定上下文无关文法的产生式$A \to a,A \in V_N,a \in V^*$
$$若a \nRightarrow^* \epsilon,则SELECT(A \to a) = FIRST(a)$$
$$若a \Rightarrow^* \epsilon,则SELECT(A \to a)=(FIRST(a) - \{\epsilon\}) \cup FOLLOW(A)$$


- 定义4.4
一个上下文无关文法是$LL(1)$文法的充要条件是，对每个非终结符的两个不同产生式，$A \to a ,A \to b$，满足
$$SELECT(A \to a) \cap SELECT(A \to b) = \emptyset$$
其中$a,b$不同时能$\Rightarrow^* \epsilon$

> $LL(1)$⽂法是能够使⽤确定的⾃顶向下分析技术的

$LL(1)$的含义是：第1个L表明⾃顶向下分析是从左向右扫描输⼊串，第2个L表明分析过程中将⽤最左推导，1表明只需向右看⼀个符号便可决定如何推导，即选择哪个产⽣式（规则）进⾏推导。类似地，也可以有LL（k）⽂法，也就是需向前查看k个符号才可确定选⽤哪个产⽣式。通常采⽤k=1，个别情况采⽤k=2。







