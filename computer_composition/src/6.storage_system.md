第六章、存储系统

在传统的CPU中，为数不多的寄存器只能暂存少量信息，绝大部分程序与数据需要存放在专门的存储器中。计算机系统结构的发展要求多层次的存储能力，这就构成了具有层次结构的存储子系统。

在物理构成上，存储系统通常分为3层
- 高速缓冲存储器Cache
- 主存
- 外存  
Cache与主存常由半导体存储器构成；外存常由磁盘及光盘构成，也可以看作是I/O设备


在本章中
- 首先介绍各种存储器存储信息的原理
- 接着介绍芯片级以上的存储器逻辑设计方法
- 然后介绍高速缓存、外部存储器的工作原理
- 最后从整个存储系统组织的角度，介绍有关技术，如物理存储系统组织、虚拟存储技术等


# 概述

简单地讲，存储器用于存放计算机程序和指令、待处理的数据、运算结果以及各种需要计算机保存的信息

存储器由一些能够表示为二进制数中0、1两种状态的物理器件组成，这些器件本身具有记忆功能，如电容、双稳态电路等。

通常一个存储单元由8个存储元构成，可存放8位二进制信息（即1字节，1 Byte）。许多存储单元组织在一起就构成了存储器。



一个高性能的计算机系统要求存储器的存储容量大，存取速度快，成本低廉，能支持复杂系统结构。这些要求往往相互矛盾，彼此形成制约，为了适应不同层次的需要，形成了多级存储体系

从用户的角度看，存储器还可以形成另一种层次结构，即
- 物理存储器: 物理存储器是指系统的物理组成中实际存在的主存，主存容量决定了实存空间的大小
- 虚拟存储器: 依靠操作系统的软件支持及部分硬件的支持，可使用户访问的编程空间远比实际主存空间大，这个存储器称为虚拟存储器。



## 存储器的分类

### 按存储器在计算机系统中的作用分类

1. 内存存储器

- 用来存储当前运行所需要的程序和数据
- CPU可以直接访问内存并与其交换信息
- 相对外部存储器而言，内存的容量小、存取速度快

2. 外存存储器

- 用于存放当前不参加运行的程序和数据，以及一些需要永久保存的信息
- 外存设在主机外部，其容量大
- 存取速度相对较慢，CPU不能直接访问它，而必须通过专门的设备才能对它进行读写（如磁盘驱动器等）

3. 高速缓存存储器

- 位于主存和CPU之间，用来存放正在执行的程序和数据，以便CPU能高速地访问它们
- Cache的存取速度可以与CPU的速度相匹配，但其价格昂贵，存储容量较小
- 目前的微处理器通常将Cache或Cache的一部分制作在CPU芯片中。



### 按存取方式分类

1. 随机存取存储器RAM(Random Access Memory)

- CPU可以对RAM单元的内容随机地读/写访问
- 对存取时间相同: 任一单元的读出和写入的花费的时间是一样，
- RAM读/写方便，但断电后信息会丢失

2. 只读存储器ROM(Read Only Memory)

- 只读存储器可以看作RAM的一种特殊形式
- 只能随机读出而不能写入
- 断电信息也不会丢失
> 有些ROM在特定条件下用特殊的装置或程序可以重新写入。

3. 顺序存取存储器SAM(Sequential Access Memory)

- 内容只能按某种顺序存取
- 存取时间的长短与信息在存储器上的物理位置有关
> 磁带机就是典型的顺序存取存储器。

4. 直接存取存储器DAM(Direct Access Memory)

- 介于RAM的随机地访问和SAM的顺序存取之间
- 存取信息时
    - 第1步直接指向存储器的某个小区域（如磁盘上的磁道）
    - 第2步在小区域内顺序检索或等待，直到找到目的地后再进行读/写操作
- 存取时间也与信息所在的物理位置有关，但比SAM的存取时间要短
> 磁盘是最常见的直接存取存储器。


### 按存储介质分类

1. 磁芯存储器

通过小型铁氧体环（磁芯）存储数据，每个磁芯的磁化方向表示1或0。
- 写入数据：通过电流改变磁化方向设定为1或0。
- 读取数据：检测磁化方向以判断状态，破坏性读出

> 破坏性读出，不管磁芯原存的信息是1或0，读出之后磁芯内容都变成0


2. 半导体存储器

采用半导体器件制造的存储器

3. 磁表面存储器

在金属或塑料基体上涂敷一层磁性材料，利用磁层的磁化状态来存储信息
- 写入数据：磁头在磁性表面通过电流改变局部磁化方向以表示1或0。
- 读取数据：磁头检测磁场变化，转换为电信号输出。

4. 光盘存储器

利用激光技术控制访问的存储器
- 写入数据：激光束烧蚀光盘表面的有机层或改变反射率，形成“坑”和“平面”表示1和0。
- 读取数据：通过激光反射强度的差异检测数据。



## 主存的主要技术指标

从理论上讲，只要具有两个明显可区分的物理状态且容易进行状态转换的器件和介质都可用来存储二进制信息

1. 存储容量

存储容量是指主存所能容纳的二进制信息总量

2. 存取速度

存取速度通常由存取时间和存取周期来表示。
- 存取时间: 指从启动一次存储器操作到完成该操作所经历的时间
- 存取周期: 指存储器进行一次完整的读/写操作所需的全部时间，即连续两次访问存储器操作之间所需的最短时间(上次存取结束到下次存取开始间的最短时间)


3. 可靠性

指规定时间内，存储器无故障读/写的概率，通常用平均无故障时间MTBF（Mean Time Between Failures）来衡量可靠性，MTBF可理解为两次故障之间的平均时间间隔


4. 存取宽度

也称为存储总线宽度，即CPU一次可以存取的数据位数或字节数。



# 存储原理

## 半导体存储器的存储原理


### 静态存储器SRAM

SRAM原理：利用双稳态触发器保存信息

![SRAM组成原理图(存一位信息)](assets/2024-12-05-14-48-53.png)


1. 组成
- mos管
    - T1,T2: 工作管
    - T3,T4: 负载管
    - T5,T6: 门控管
- W: 位线
- Z: 字线


2. 定义

- 存0： T1导通，T2截止
- 存1： T2导通，T1截止


3. 存取操作

- 写入: z接高电平，T5,T6导通
    - 写0：$\overline{W}$加低，W加高， T6 对 B 充 电 ， 使 T1导通，T2截止；
    - 写1：相反，T5对A充电，使T2导通



### 动态存储器DRAM



## 磁表面存储器的存储原理

1. 记录介质与磁头

- 介质: 磁层（矩磁薄膜），依附在基体上
- 磁头: 读写部件

2. 读写原理、特点

- 写入(电磁转换)

    磁头线圈中加入磁化电流（写电流），并使磁层移动，在磁层上形成连续的小段磁化区域（位单元）

- 读出（磁电转换）

    磁头线圈中不加电流，磁层移动。当位单元的转变区经过磁头下方时，在线圈两端产生感应电势



## 光存储器的存储原理

1. 环变形光盘

形变不可逆，不可改写
- 定义: 有空为1，无孔为0
- 写入:
    - 写1，⾼功率激光照射介质，形成凹坑；
    - 写0，不发射激光束，介质不变
- 读出: 低功率激光扫描光道，根据反射光强弱判断是1或0

2. 相变形光盘

相变可逆，可改写
- 写入: 
    - 写1，⾼功率激光照射介质，晶粒直径变⼤；
    - 写0，不发射激光束，晶粒不变
- 读出: 低功率激光扫描光道，根据反射率的差别判断是1或0


3. 磁光形光盘

磁化方向，可恢复可改写
- 写入前：外加磁场，使介质呈某种磁化⽅向
- 写入:
    - 写1，激光照射并外加磁场改变磁化⽅向；
    - 写0，未被照射区域，磁化⽅向不变
- 读出: 低功率激光扫描光道，根据反射光的偏转角度判断是1或0 （通过检偏器为1）




# 主存储器的组织




<!-- TODO: P592 -->

































