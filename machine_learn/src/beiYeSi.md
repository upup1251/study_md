贝叶斯分类器

[toc]

# 1. 贝叶斯


## 1.1 概率术语： 
- 概率：特点环境下某事件发生的可能性
- 先验概率$P(C)$: 根据以往的经验分析所得到的概率
- 后验概率$P(C|x)$: 通过观测或其他方法获取样本信息
- 联合概率：几个事件同时发生时的概率
- 似然：基于已经发生的结果，推断产生这个结果的可能环境因素


## 1.2 贝叶斯定理：
$$P(y|x) = \frac{P(x|y)P(y)}{P(x)}$$
- $y$: 结果集合$Y$中的一个取值
- $x$: 给定的属性集数据$x_0,x_1,...,x_n,(0 \lt n)$

## 1.3 计算步骤

1. 对结果集合$Y$中的各个取值$y_i$求$P(y_i|x)$概率
2. 概率最大的$y_i$即为预测结果
    - 各个$y_i$的结果求得的分母$P(x)$是相同的
    - 只需要比较分子$p(x|y_i)P(y_i)$即可  


所有属性集上的联合概率难从有限的训练样本估计获得，因此提出朴素贝叶斯对其进行简化



# 2. 朴素贝叶斯

假定目标数据属性集$x$中个属性相互独立

$$P(y|x) = \frac{P(x|y)P(y)}{P(x)} = \frac{P(y)\prod_{i=1}^nP(x_i|y)}{P(x)}$$
- $y$: 结果集中的一个结果
- $n$: 属性数量
- $x_i$: $x_i$在第i个属性上的取值


## 2.1 拉普拉斯修正


若某个属性值在训练集中没有出现过，计算$\prod_{i=1}^nP(x_i|y)$时，会导致结果为0


拉普拉斯修正：
- 通过对 ***所有事件*** 的 ***频数加1*** 来解决零概率问题
- 确保即使在训练数据中未见过的事件，在测试时也不会出现概率为零的情况


## 2.2 流程

1. 计算类先验概率$P(y)$
2. 为每个属性计算条件概率$P(x_i|y)$
3. 计算$P(y|x) = P(y) \prod_{i=1}^nP(x_i|y)$
4. 根据$max_{y \in Y} P(y) \prod_{i=1}^nP(x_i|y)$得到结果类$y$


## 2.3 对数似然估计

对数似然（log-likelihood）的使用可以
- 有效避免计算过程中因乘积的概率过小而导致的数值下溢问题
- 同时将乘法运算转化为更易处理的加法运算

计算$P(x|y)P(y)$时，如果特征$x$是高维的，似然$P(x|y)$通常是各特征项条件独立的联合分布:
$$P(x|y)P(y) = P(y) \prod_{i=1}^n P(x_i|y)$$

如果$n$很大，多个小数概率相乘会导致数据下溢，可使用对数似然，对他们取对数，将乘法转换成加法：
$$\log P(x|y) + \log P(y) = \sum_{i=1}^n \log P(x_i|y) + \log P(y)$$
比较各类别的值，选择最大的类别作为预测结果



